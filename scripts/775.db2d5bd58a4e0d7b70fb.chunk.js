/*! For license information please see 775.db2d5bd58a4e0d7b70fb.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkglobalshorts_frontend=self.webpackChunkglobalshorts_frontend||[]).push([[775],{775(t,e,n){function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function a(){var t,e,n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function s(n,i,a,r){var s=i&&i.prototype instanceof l?i:l,d=Object.create(s.prototype);return o(d,"_invoke",function(n,i,a){var o,r,s,l=0,d=a||[],u=!1,v={p:0,n:0,v:t,a:m,f:m.bind(t,4),d:function(e,n){return o=e,r=0,s=t,v.n=n,c}};function m(n,i){for(r=n,s=i,e=0;!u&&l&&!a&&e<d.length;e++){var a,o=d[e],m=v.p,h=o[2];n>3?(a=h===i)&&(s=o[(r=o[4])?5:(r=3,3)],o[4]=o[5]=t):o[0]<=m&&((a=n<2&&m<o[1])?(r=0,v.v=i,v.n=o[1]):m<h&&(a=n<3||o[0]>i||i>h)&&(o[4]=n,o[5]=i,v.n=h,r=0))}if(a||n>1)return c;throw u=!0,i}return function(a,d,h){if(l>1)throw TypeError("Generator is already running");for(u&&1===d&&m(d,h),r=d,s=h;(e=r<2?t:s)||!u;){o||(r?r<3?(r>1&&(v.n=-1),m(r,s)):v.n=s:v.v=s);try{if(l=2,o){if(r||(a="next"),e=o[a]){if(!(e=e.call(o,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,r<2&&(r=0)}else 1===r&&(e=o.return)&&e.call(o),r<2&&(s=TypeError("The iterator does not provide a '"+a+"' method"),r=1);o=t}else if((e=(u=v.n<0)?s:n.call(i,v))!==c)break}catch(e){o=t,r=1,s=e}finally{l=1}}return{value:e,done:u}}}(n,a,r),!0),d}var c={};function l(){}function d(){}function u(){}e=Object.getPrototypeOf;var v=[][i]?e(e([][i]())):(o(e={},i,function(){return this}),e),m=u.prototype=l.prototype=Object.create(v);function h(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,o(t,r,"GeneratorFunction")),t.prototype=Object.create(m),t}return d.prototype=u,o(m,"constructor",u),o(u,"constructor",d),d.displayName="GeneratorFunction",o(u,r,"GeneratorFunction"),o(m),o(m,r,"Generator"),o(m,i,function(){return this}),o(m,"toString",function(){return"[object Generator]"}),(a=function(){return{w:s,m:h}})()}function o(t,e,n,i){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}o=function(t,e,n,i){function r(e,n){o(t,e,function(t){return this._invoke(e,n,t)})}e?a?a(t,e,{value:n,enumerable:!i,configurable:!i,writable:!i}):t[e]=n:(r("next",0),r("throw",1),r("return",2))},o(t,e,n,i)}function r(t,e,n,i,a,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,a)}function s(t){return function(){var e=this,n=arguments;return new Promise(function(i,a){var o=t.apply(e,n);function s(t){r(o,i,a,s,c,"next",t)}function c(t){r(o,i,a,s,c,"throw",t)}s(void 0)})}}function c(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,l(i.key),i)}}function l(t){var e=function(t){if("object"!=i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(e)?e:e+""}n.r(e),n.d(e,{default:()=>d});var d=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.params=e,this.userData=null,this.activeTab="profile",this.init()},e=[{key:"init",value:(v=s(a().m(function t(){return a().w(function(t){for(;;)switch(t.n){case 0:if(console.log("Profile page initialized",this.params),window.auth.isLoggedIn()){t.n=1;break}return window.router.navigate("/login",{redirect:"profile"}),t.a(2);case 1:return this.showLoading(),t.n=2,this.loadUserData();case 2:this.initTabs(),this.loadProfileData(),this.loadHistoryData(),this.loadFavoritesData(),this.bindEvents(),this.hideLoading();case 3:return t.a(2)}},t,this)})),function(){return v.apply(this,arguments)})},{key:"loadUserData",value:(u=s(a().m(function t(){return a().w(function(t){for(;;)switch(t.n){case 0:try{this.userData={id:"user_123",username:"john_smith",email:"john@example.com",fullName:"John Smith",avatar:"/images/default-avatar.jpg",coins:1250,isVip:!0,vipExpiresAt:"2024-12-31",watchHours:142,dramasWatched:38,episodesWatched:245,createdAt:"2024-01-15",country:"US",language:"en"},this.updateUserInfo()}catch(t){console.error("Failed to load user data:",t),this.showError("加载用户数据失败")}case 1:return t.a(2)}},t,this)})),function(){return u.apply(this,arguments)})},{key:"updateUserInfo",value:function(){var t=document.querySelector(".profile-avatar");if(t){var e=this.userData.username.charAt(0).toUpperCase();t.textContent=e}if(document.querySelector(".profile-name").innerHTML="\n            ".concat(this.userData.fullName||this.userData.username,"\n            ").concat(this.userData.isVip?'<span class="vip-badge"><i class="fas fa-crown"></i> VIP</span>':"","\n        "),document.querySelector(".profile-email").innerHTML='\n            <i class="fas fa-envelope"></i> '.concat(this.userData.email,"\n        "),document.getElementById("watchHours").textContent=this.userData.watchHours,document.getElementById("dramaCount").textContent=this.userData.dramasWatched,document.getElementById("episodeCount").textContent=this.userData.episodesWatched,this.userData.isVip){var n=document.querySelector(".vip-status-container");if(n){var i=new Date(this.userData.vipExpiresAt),a=Math.ceil((i-new Date)/864e5);n.querySelector(".vip-details p").textContent="有效期至 ".concat(this.userData.vipExpiresAt," · 剩余").concat(a,"天")}}else this.showNonVipStatus();document.querySelector(".coin-amount span").textContent=this.userData.coins.toLocaleString()}},{key:"showNonVipStatus",value:function(){var t,e=document.querySelector(".vip-status-container");e&&(e.innerHTML='\n                <div class="vip-info">\n                    <div class="vip-icon">\n                        <i class="fas fa-crown" style="opacity: 0.3;"></i>\n                    </div>\n                    <div class="vip-details">\n                        <h3>尚未开通VIP</h3>\n                        <p>开通VIP享受无广告观看、独家内容等特权</p>\n                    </div>\n                </div>\n                <button class="btn btn-primary" id="upgradeVipBtn">\n                    <i class="fas fa-gem"></i>\n                    立即开通\n                </button>\n            ',null===(t=document.getElementById("upgradeVipBtn"))||void 0===t||t.addEventListener("click",function(){window.router.navigate("/payment",{tab:"vip"})}))}},{key:"initTabs",value:function(){var t=this,e=document.querySelectorAll(".profile-tab");e.forEach(function(n){n.addEventListener("click",function(){var i=n.dataset.tab;e.forEach(function(t){return t.classList.remove("active")}),n.classList.add("active"),t.switchTab(i)})})}},{key:"switchTab",value:function(t){this.activeTab=t,document.querySelectorAll(".tab-content").forEach(function(t){t.classList.remove("active")}),document.getElementById("".concat(t,"Tab")).classList.add("active")}},{key:"loadProfileData",value:function(){document.getElementById("displayName").value=this.userData.fullName||"",document.getElementById("email").value=this.userData.email,document.getElementById("country").value=this.userData.country||"",document.getElementById("language").value=this.userData.language||"en"}},{key:"loadHistoryData",value:(d=s(a().m(function t(){var e,n,i=this;return a().w(function(t){for(;;)switch(t.n){case 0:if(e=document.getElementById("historyList")){t.n=1;break}return t.a(2);case 1:try{n=[{id:1,dramaTitle:"总裁的秘密婚姻",episode:"第5集 契约的开始",time:"2小时前",progress:65,thumbnail:"/images/history1.jpg"},{id:2,dramaTitle:"爱情在巴黎",episode:"第12集 塞纳河畔",time:"昨天",progress:100,thumbnail:"/images/history2.jpg"},{id:3,dramaTitle:"我的狼人上司",episode:"第3集 满月之夜",time:"2天前",progress:45,thumbnail:"/images/history3.jpg"},{id:4,dramaTitle:"亿万富翁的错嫁妻",episode:"第8集 真相大白",time:"3天前",progress:80,thumbnail:"/images/history4.jpg"},{id:5,dramaTitle:"办公室恋爱101",episode:"第1集 初次见面",time:"1周前",progress:100,thumbnail:"/images/history5.jpg"}],e.innerHTML="",n.forEach(function(t){var n=i.createHistoryItem(t);e.appendChild(n)})}catch(t){console.error("Failed to load history:",t),e.innerHTML='<div class="empty-state">加载失败</div>'}case 2:return t.a(2)}},t)})),function(){return d.apply(this,arguments)})},{key:"createHistoryItem",value:function(t){var e=document.createElement("div");return e.className="history-item",e.innerHTML='\n            <div class="history-thumb">\n                <img src="'.concat(t.thumbnail,'" alt="').concat(t.dramaTitle,'">\n            </div>\n            <div class="history-info">\n                <div class="history-title">').concat(t.dramaTitle,'</div>\n                <div class="history-meta">\n                    <span>').concat(t.episode,"</span>\n                    <span>").concat(t.time,'</span>\n                </div>\n                <div class="history-progress">\n                    <div class="history-progress-bar" style="width: ').concat(t.progress,'%"></div>\n                </div>\n            </div>\n        '),e.addEventListener("click",function(){window.router.navigate("/player/".concat(t.id))}),e}},{key:"loadFavoritesData",value:(l=s(a().m(function t(){var e,n,i=this;return a().w(function(t){for(;;)switch(t.n){case 0:if(e=document.getElementById("favoritesGrid")){t.n=1;break}return t.a(2);case 1:try{n=[{id:1,title:"总裁的秘密婚姻",episodes:12,isVip:!0,thumbnail:"/images/fav1.jpg"},{id:2,title:"前妻的复仇",episodes:30,isVip:!0,thumbnail:"/images/fav2.jpg"},{id:3,title:"爱情在巴黎",episodes:24,isVip:!1,thumbnail:"/images/fav3.jpg"},{id:4,title:"血红玫瑰之谜",episodes:16,isVip:!1,thumbnail:"/images/fav4.jpg"},{id:5,title:"隔壁的吸血鬼",episodes:15,isVip:!1,thumbnail:"/images/fav5.jpg"},{id:6,title:"我的狼人上司",episodes:18,isVip:!1,thumbnail:"/images/fav6.jpg"}],e.innerHTML="",n.forEach(function(t){var n=i.createFavoriteItem(t);e.appendChild(n)})}catch(t){console.error("Failed to load favorites:",t),e.innerHTML='<div class="empty-state">加载失败</div>'}case 2:return t.a(2)}},t)})),function(){return l.apply(this,arguments)})},{key:"createFavoriteItem",value:function(t){var e=document.createElement("div");return e.className="favorite-item",e.innerHTML='\n            <div class="favorite-thumb">\n                <img src="'.concat(t.thumbnail,'" alt="').concat(t.title,'">\n                ').concat(t.isVip?'<div class="vip-badge">VIP</div>':"",'\n            </div>\n            <div class="favorite-info">\n                <div class="favorite-title">').concat(t.title,'</div>\n                <div class="favorite-meta">').concat(t.episodes,"集</div>\n            </div>\n        "),e.addEventListener("click",function(){window.router.navigate("/player/".concat(t.id))}),e}},{key:"loadTransactions",value:(r=s(a().m(function t(){var e,n,i=this;return a().w(function(t){for(;;)switch(t.n){case 0:if(e=document.getElementById("transactionsList")){t.n=1;break}return t.a(2);case 1:try{n=[{id:1,type:"earned",title:"每日签到",description:"第7天连续签到",amount:50,date:"今天"},{id:2,type:"spent",title:"解锁剧集",description:"总裁的秘密婚姻 - 第6集",amount:-30,date:"今天"},{id:3,type:"earned",title:"邀请奖励",description:"好友 Sarah 注册",amount:100,date:"昨天"},{id:4,type:"earned",title:"观看广告",description:"30秒广告奖励",amount:10,date:"2天前"},{id:5,type:"spent",title:"解锁剧集",description:"前妻的复仇 - 全集",amount:-200,date:"3天前"}],e.innerHTML="",n.forEach(function(t){var n=i.createTransactionItem(t);e.appendChild(n)})}catch(t){console.error("Failed to load transactions:",t)}case 2:return t.a(2)}},t)})),function(){return r.apply(this,arguments)})},{key:"createTransactionItem",value:function(t){var e=document.createElement("div");return e.className="transaction-item transaction-".concat(t.type),e.innerHTML='\n            <div class="transaction-info">\n                <div class="transaction-icon">\n                    <i class="fas fa-'.concat("earned"===t.type?"plus":"minus",'"></i>\n                </div>\n                <div class="transaction-details">\n                    <h4>').concat(t.title,"</h4>\n                    <p>").concat(t.description," · ").concat(t.date,'</p>\n                </div>\n            </div>\n            <div class="transaction-amount">\n                ').concat("earned"===t.type?"+":"").concat(t.amount,"\n            </div>\n        "),e}},{key:"bindEvents",value:function(){var t,e,n,i,a,o,r,s,c,l,d,u,v,m,h=this;null===(t=document.getElementById("editProfileBtn"))||void 0===t||t.addEventListener("click",function(){h.showEditProfileModal()}),null===(e=document.getElementById("settingsBtn"))||void 0===e||e.addEventListener("click",function(){h.switchTab("settings")}),null===(n=document.getElementById("manageVipBtn"))||void 0===n||n.addEventListener("click",function(){window.router.navigate("/payment",{tab:"vip"})}),null===(i=document.getElementById("viewAllHistory"))||void 0===i||i.addEventListener("click",function(){h.switchTab("history")}),null===(a=document.getElementById("viewAllFavorites"))||void 0===a||a.addEventListener("click",function(){h.switchTab("favorites")}),null===(o=document.getElementById("viewAllTransactions"))||void 0===o||o.addEventListener("click",function(){window.router.navigate("/payment",{tab:"history"})}),null===(r=document.getElementById("earnCoinsBtn"))||void 0===r||r.addEventListener("click",function(){h.showEarnCoinsModal()}),null===(s=document.getElementById("buyCoinsBtn"))||void 0===s||s.addEventListener("click",function(){window.router.navigate("/payment")}),null===(c=document.getElementById("withdrawCoinsBtn"))||void 0===c||c.addEventListener("click",function(){h.showWithdrawModal()}),document.querySelectorAll(".setting-item").forEach(function(t){t.addEventListener("click",function(e){var n=t.id;h.handleSettingClick(n,e)})}),null===(l=document.getElementById("saveProfileBtn"))||void 0===l||l.addEventListener("click",function(){h.saveProfile()}),null===(d=document.getElementById("cancelEditBtn"))||void 0===d||d.addEventListener("click",function(){h.hideEditProfileModal()}),document.querySelectorAll(".close-modal").forEach(function(t){t.addEventListener("click",function(t){var e=t.target.closest(".modal-overlay");e&&e.classList.remove("active")})}),document.querySelectorAll(".modal-overlay").forEach(function(t){t.addEventListener("click",function(e){e.target===t&&t.classList.remove("active")})}),null===(u=document.getElementById("notificationToggle"))||void 0===u||u.addEventListener("change",function(t){h.saveNotificationSetting(t.target.checked)}),null===(v=document.getElementById("languageSettings"))||void 0===v||v.addEventListener("click",function(){h.showLanguageModal()}),null===(m=document.getElementById("logoutBtn"))||void 0===m||m.addEventListener("click",function(){h.handleLogout()})}},{key:"handleSettingClick",value:function(t,e){if(!e.target.closest(".switch"))switch(t){case"notificationSettings":break;case"languageSettings":this.showLanguageModal();break;case"playbackSettings":this.showPlaybackSettings();break;case"privacySettings":this.showPrivacySettings();break;case"helpSettings":this.showHelp();break;case"logoutBtn":this.handleLogout()}}},{key:"showEditProfileModal",value:function(){var t=document.getElementById("editProfileModal");t&&(document.getElementById("editDisplayName").value=this.userData.fullName||"",document.getElementById("editEmail").value=this.userData.email,t.classList.add("active"))}},{key:"hideEditProfileModal",value:function(){var t=document.getElementById("editProfileModal");t&&t.classList.remove("active")}},{key:"saveProfile",value:(o=s(a().m(function t(){var e,n,i=this;return a().w(function(t){for(;;)switch(t.n){case 0:if(e=document.getElementById("editDisplayName").value.trim(),n=document.getElementById("editEmail").value.trim(),e&&n){t.n=1;break}return this.showError("请填写所有字段"),t.a(2);case 1:this.showLoading(),setTimeout(function(){i.userData.fullName=e,i.userData.email=n,i.updateUserInfo(),i.hideEditProfileModal(),i.hideLoading(),i.showToast("资料已更新")},1e3);case 2:return t.a(2)}},t,this)})),function(){return o.apply(this,arguments)})},{key:"showEarnCoinsModal",value:function(){var t,e=this,n=document.createElement("div");n.className="modal-overlay active",n.innerHTML='\n            <div class="modal">\n                <div class="modal-header">\n                    <h3 class="modal-title">赚取金币</h3>\n                    <button class="close-modal"><i class="fas fa-times"></i></button>\n                </div>\n                <div class="modal-body">\n                    <div class="earn-options">\n                        <div class="earn-option">\n                            <i class="fas fa-calendar-check"></i>\n                            <div>\n                                <h4>每日签到</h4>\n                                <p>每天签到获得10-50金币</p>\n                                <button class="btn btn-primary btn-sm" id="dailyCheckinBtn">立即签到</button>\n                            </div>\n                        </div>\n                        <div class="earn-option">\n                            <i class="fas fa-users"></i>\n                            <div>\n                                <h4>邀请好友</h4>\n                                <p>每邀请一位好友获得100金币</p>\n                                <button class="btn btn-primary btn-sm" id="inviteBtn">邀请好友</button>\n                            </div>\n                        </div>\n                        <div class="earn-option">\n                            <i class="fas fa-ad"></i>\n                            <div>\n                                <h4>观看广告</h4>\n                                <p>观看广告获得5-20金币</p>\n                                <button class="btn btn-primary btn-sm" id="watchAdBtn">观看广告</button>\n                            </div>\n                        </div>\n                        <div class="earn-option">\n                            <i class="fas fa-share-alt"></i>\n                            <div>\n                                <h4>分享内容</h4>\n                                <p>分享剧集给好友获得30金币</p>\n                                <button class="btn btn-primary btn-sm" id="shareContentBtn">立即分享</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        ',document.body.appendChild(n),n.querySelector(".close-modal").addEventListener("click",function(){n.remove()}),n.addEventListener("click",function(t){t.target===n&&n.remove()}),null===(t=n.querySelector("#dailyCheckinBtn"))||void 0===t||t.addEventListener("click",function(){e.handleCheckin()})}},{key:"handleCheckin",value:(i=s(a().m(function t(){return a().w(function(t){for(;;)switch(t.n){case 0:this.showToast("签到成功 +50金币"),this.userData.coins+=50,document.querySelector(".coin-amount span").textContent=this.userData.coins.toLocaleString();case 1:return t.a(2)}},t,this)})),function(){return i.apply(this,arguments)})},{key:"showWithdrawModal",value:function(){var t,e=this,n=document.createElement("div");n.className="modal-overlay active",n.innerHTML='\n            <div class="modal">\n                <div class="modal-header">\n                    <h3 class="modal-title">提现金币</h3>\n                    <button class="close-modal"><i class="fas fa-times"></i></button>\n                </div>\n                <div class="modal-body">\n                    <div class="withdraw-info">\n                        <p>当前可用金币: <strong>'.concat(this.userData.coins,'</strong></p>\n                        <p>1000金币 = $1.00 USD</p>\n                    </div>\n                    <div class="form-group">\n                        <label class="form-label">提现金额</label>\n                        <select class="form-control" id="withdrawAmount">\n                            <option value="1000">1000金币 ($1.00)</option>\n                            <option value="5000">5000金币 ($5.00)</option>\n                            <option value="10000">10000金币 ($10.00)</option>\n                            <option value="50000">50000金币 ($50.00)</option>\n                        </select>\n                    </div>\n                    <div class="form-group">\n                        <label class="form-label">提现方式</label>\n                        <select class="form-control" id="withdrawMethod">\n                            <option value="paypal">PayPal</option>\n                            <option value="alipay">支付宝</option>\n                            <option value="wechat">微信支付</option>\n                        </select>\n                    </div>\n                    <div class="form-group">\n                        <label class="form-label">账户信息</label>\n                        <input type="text" class="form-control" placeholder="输入你的账户邮箱/账号">\n                    </div>\n                    <button class="btn btn-primary" id="submitWithdrawBtn">提交提现申请</button>\n                </div>\n            </div>\n        '),document.body.appendChild(n),n.querySelector(".close-modal").addEventListener("click",function(){n.remove()}),n.addEventListener("click",function(t){t.target===n&&n.remove()}),null===(t=n.querySelector("#submitWithdrawBtn"))||void 0===t||t.addEventListener("click",function(){e.showToast("提现申请已提交，预计1-3个工作日到账"),n.remove()})}},{key:"showLanguageModal",value:function(){var t=document.getElementById("languageModal");t&&t.classList.add("active")}},{key:"showPlaybackSettings",value:function(){this.showToast("播放设置功能开发中")}},{key:"showPrivacySettings",value:function(){this.showToast("隐私设置功能开发中")}},{key:"showHelp",value:function(){window.open("https://help.globalshorts.com","_blank")}},{key:"saveNotificationSetting",value:(n=s(a().m(function t(e){return a().w(function(t){for(;;)switch(t.n){case 0:console.log("Notification setting saved:",e),this.showToast(e?"通知已开启":"通知已关闭");case 1:return t.a(2)}},t,this)})),function(t){return n.apply(this,arguments)})},{key:"handleLogout",value:function(){confirm("确定要退出登录吗？")&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.auth.logout(),window.router.navigate("/"),this.showToast("已退出登录"))}},{key:"showLoading",value:function(){var t=document.getElementById("pageLoading");t&&t.classList.add("show")}},{key:"hideLoading",value:function(){var t=document.getElementById("pageLoading");t&&t.classList.remove("show")}},{key:"showToast",value:function(t){var e=new CustomEvent("showToast",{detail:{message:t,type:"success"}});document.dispatchEvent(e)}},{key:"showError",value:function(t){var e=new CustomEvent("showToast",{detail:{message:t,type:"error"}});document.dispatchEvent(e)}},{key:"destroy",value:function(){console.log("Profile page destroyed")}}],e&&c(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,i,o,r,l,d,u,v}()}}]);