class PlayerControls{constructor(t){this.player=t,this.container=t.dom.controls,this.init()}init(){this.createControls(),this.setupEventListeners(),this.updateTimeDisplay()}createControls(){this.container.innerHTML='\n            <div class="controls-left">\n                <button class="control-btn play-pause">\n                    <i class="fas fa-play"></i>\n                    <i class="fas fa-pause"></i>\n                </button>\n                \n                <button class="control-btn prev">\n                    <i class="fas fa-step-backward"></i>\n                </button>\n                \n                <button class="control-btn next">\n                    <i class="fas fa-step-forward"></i>\n                </button>\n                \n                <div class="volume-control">\n                    <button class="control-btn volume">\n                        <i class="fas fa-volume-up"></i>\n                        <i class="fas fa-volume-mute"></i>\n                    </button>\n                    <div class="volume-slider">\n                        <div class="volume-progress"></div>\n                        <input type="range" class="volume-range" min="0" max="1" step="0.01" value="1">\n                    </div>\n                </div>\n                \n                <div class="time-display">\n                    <span class="current-time">00:00</span>\n                    <span class="time-separator">/</span>\n                    <span class="duration">00:00</span>\n                </div>\n            </div>\n            \n            <div class="progress-bar-container">\n                <div class="progress-bar">\n                    <div class="buffered-progress"></div>\n                    <div class="play-progress"></div>\n                    <div class="progress-handle"></div>\n                    <input type="range" class="progress-range" min="0" max="100" step="0.1" value="0">\n                </div>\n            </div>\n            \n            <div class="controls-right">\n                <button class="control-btn subtitle" title="字幕">\n                    <i class="fas fa-closed-captioning"></i>\n                </button>\n                \n                <button class="control-btn quality" title="清晰度">\n                    <i class="fas fa-hd"></i>\n                </button>\n                \n                <button class="control-btn speed" title="播放速度">\n                    <i class="fas fa-running"></i>\n                    <span class="speed-text">1x</span>\n                </button>\n                \n                <button class="control-btn audio-mode" title="听剧模式">\n                    <i class="fas fa-headphones"></i>\n                </button>\n                \n                <button class="control-btn download" title="下载">\n                    <i class="fas fa-download"></i>\n                </button>\n                \n                <button class="control-btn pip" title="画中画">\n                    <i class="fas fa-clone"></i>\n                </button>\n                \n                <button class="control-btn fullscreen">\n                    <i class="fas fa-expand"></i>\n                    <i class="fas fa-compress"></i>\n                </button>\n            </div>\n        ',this.dom={playPause:this.container.querySelector(".play-pause"),prev:this.container.querySelector(".prev"),next:this.container.querySelector(".next"),volume:this.container.querySelector(".volume"),volumeRange:this.container.querySelector(".volume-range"),volumeProgress:this.container.querySelector(".volume-progress"),currentTime:this.container.querySelector(".current-time"),duration:this.container.querySelector(".duration"),progressRange:this.container.querySelector(".progress-range"),playProgress:this.container.querySelector(".play-progress"),bufferedProgress:this.container.querySelector(".buffered-progress"),subtitle:this.container.querySelector(".subtitle"),quality:this.container.querySelector(".quality"),speed:this.container.querySelector(".speed"),speedText:this.container.querySelector(".speed-text"),audioMode:this.container.querySelector(".audio-mode"),download:this.container.querySelector(".download"),pip:this.container.querySelector(".pip"),fullscreen:this.container.querySelector(".fullscreen")}}setupEventListeners(){this.dom.playPause.addEventListener("click",()=>this.player.togglePlay()),this.dom.prev.addEventListener("click",()=>{this.player.trigger("prevEpisode")}),this.dom.next.addEventListener("click",()=>{this.player.trigger("nextEpisode")}),this.dom.volume.addEventListener("click",()=>this.player.toggleMute()),this.dom.volumeRange.addEventListener("input",t=>{const e=parseFloat(t.target.value);this.player.setVolume(e),this.updateVolumeDisplay(e)}),this.dom.progressRange.addEventListener("input",t=>{const e=parseFloat(t.target.value),s=e/100*this.player.state.duration;this.player.seek(s),this.updateProgressDisplay(e)}),this.dom.subtitle.addEventListener("click",()=>{this.player.trigger("showSubtitleMenu")}),this.dom.quality.addEventListener("click",()=>{this.player.trigger("showQualityMenu")}),this.dom.speed.addEventListener("click",()=>{this.player.trigger("showSpeedMenu")}),this.dom.audioMode.addEventListener("click",()=>{this.player.state.isAudioMode?this.player.disableAudioMode():this.player.enableAudioMode()}),this.dom.download.addEventListener("click",()=>this.player.download()),this.dom.pip.addEventListener("click",()=>this.player.togglePictureInPicture()),this.dom.fullscreen.addEventListener("click",()=>this.player.toggleFullscreen()),this.player.on("play",()=>this.updatePlayState(!0)),this.player.on("pause",()=>this.updatePlayState(!1)),this.player.on("timeupdate",()=>this.updateTime()),this.player.on("progress",()=>this.updateBuffered()),this.player.on("volumechange",()=>this.updateVolume()),this.player.on("ratechange",()=>this.updatePlaybackRate()),this.player.on("qualitychange",t=>this.updateQuality(t))}updatePlayState(t){t?this.dom.playPause.classList.add("playing"):this.dom.playPause.classList.remove("playing")}updateTime(){const t=this.player.state.currentTime,e=this.player.state.duration;if(this.dom.currentTime.textContent=this.formatTime(t),this.dom.duration.textContent=this.formatTime(e),e>0){const s=t/e*100;this.updateProgressDisplay(s)}}updateBuffered(){const t=this.player.state.buffered,e=this.player.state.duration;if(e>0){const s=t/e*100;this.dom.bufferedProgress.style.width=`${s}%`}}updateProgressDisplay(t){this.dom.playProgress.style.width=`${t}%`,this.dom.progressRange.value=t}updateVolume(){const t=this.player.state.volume,e=this.player.state.muted;this.dom.volumeRange.value=e?0:t,this.updateVolumeDisplay(e?0:t),e||0===t?this.dom.volume.classList.add("muted"):this.dom.volume.classList.remove("muted")}updateVolumeDisplay(t){this.dom.volumeProgress.style.width=100*t+"%"}updatePlaybackRate(){const t=this.player.state.playbackRate;this.dom.speedText.textContent=`${t}x`}updateQuality(t){"1080p"===t?this.dom.quality.classList.add("hd"):this.dom.quality.classList.remove("hd")}formatTime(t){if(isNaN(t))return"00:00";const e=Math.floor(t/3600),s=Math.floor(t%3600/60),a=Math.floor(t%60);return e>0?`${e}:${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`:`${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`}destroy(){}}export default PlayerControls;