class AudioMode{constructor(e){this.player=e,this.isActive=!1,this.audioElement=null}enable(){if(this.isActive)return;const e=this.player.el(),i=new Audio;e.querySelectorAll("source").forEach(e=>{const t=document.createElement("source");t.src=e.src,t.type=e.type,i.appendChild(t)}),i.currentTime=this.player.currentTime(),i.play(),e.style.opacity="0",e.style.position="absolute",this.audioElement=i,this.isActive=!0,this.player.pause(),this.player.on("play",()=>{this.isActive&&this.audioElement.play()}),this.player.on("pause",()=>{this.isActive&&this.audioElement.pause()}),this.setupBackgroundPlayback()}disable(){if(!this.isActive)return;const e=this.player.el();e.style.opacity="",e.style.position="",this.audioElement&&(this.player.currentTime(this.audioElement.currentTime),this.audioElement.pause(),this.audioElement=null),this.isActive=!1}setupBackgroundPlayback(){document.addEventListener("visibilitychange",()=>{document.hidden&&this.isActive&&this.audioElement&&this.audioElement.play()}),"mediaSession"in navigator&&(navigator.mediaSession.setActionHandler("play",()=>{this.audioElement.play()}),navigator.mediaSession.setActionHandler("pause",()=>{this.audioElement.pause()}),navigator.mediaSession.setActionHandler("seekbackward",e=>{this.audioElement.currentTime=Math.max(this.audioElement.currentTime-(e.seekOffset||10),0)}),navigator.mediaSession.setActionHandler("seekforward",e=>{this.audioElement.currentTime=Math.min(this.audioElement.currentTime+(e.seekOffset||10),this.audioElement.duration)}))}}export default AudioMode;