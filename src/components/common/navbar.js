window.auth||(window.auth={isLoggedIn:()=>!1,isVIP:()=>!1,logout:()=>{}});export default class Navbar{constructor(){this.container=null,this.user=null,this.init()}init(){this.render(),this.loadUserData(),this.bindEvents()}render(){const n=document.createElement("header");n.className="main-header",n.innerHTML='\n            <div class="container">\n                <div class="header-left">\n                    <div class="logo" id="homeLink">\n                        <i class="fas fa-globe-americas"></i>\n                        <span>Global Shorts</span>\n                    </div>\n                </div>\n                \n                <div class="header-right">\n                    <div class="language-selector" id="languageSelector">\n                        <button class="lang-btn">\n                            <i class="fas fa-language"></i>\n                            <span id="currentLang">EN</span>\n                            <i class="fas fa-chevron-down"></i>\n                        </button>\n                    </div>\n                    \n                    <div class="user-info" id="userInfo">\n                        <div class="coin-display" id="coinDisplay">\n                            <i class="fas fa-coins"></i>\n                            <span>0</span>\n                        </div>\n                        \n                        <div class="auth-buttons" id="authButtons">\n                            <button class="btn btn-secondary" id="loginBtn">\n                                <i class="fas fa-sign-in-alt"></i>\n                                <span>登录</span>\n                            </button>\n                            <button class="btn btn-primary" id="registerBtn">\n                                <i class="fas fa-user-plus"></i>\n                                <span>注册</span>\n                            </button>\n                        </div>\n                        \n                        <div class="user-profile" id="userProfile" style="display: none;">\n                            <div class="user-avatar" id="userAvatar">\n                                <span id="userInitials">U</span>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        ',document.body.insertBefore(n,document.body.firstChild),this.container=n}async loadUserData(){if(window.auth.isLoggedIn())try{const n=await fetch("/api/user/profile",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),e=await n.json();e.success&&(this.user=e.data,this.showUserProfile(),this.updateCoinBalance(this.user.coins))}catch(n){console.error("Failed to load user data:",n)}else this.showLoginButtons()}showLoginButtons(){document.getElementById("authButtons").style.display="flex",document.getElementById("userProfile").style.display="none"}showUserProfile(){document.getElementById("authButtons").style.display="none",document.getElementById("userProfile").style.display="block";const n=this.user.username.charAt(0).toUpperCase();document.getElementById("userInitials").textContent=n}updateCoinBalance(n){document.querySelector(".coin-display span").textContent=n}bindEvents(){document.getElementById("homeLink")?.addEventListener("click",()=>{window.router.navigate("/")}),document.getElementById("loginBtn")?.addEventListener("click",()=>{window.router.navigate("/login")}),document.getElementById("registerBtn")?.addEventListener("click",()=>{window.router.navigate("/login?tab=register")}),document.getElementById("userAvatar")?.addEventListener("click",()=>{window.router.navigate("/profile")}),document.getElementById("coinDisplay")?.addEventListener("click",()=>{window.router.navigate("/payment")}),document.getElementById("languageSelector")?.addEventListener("click",()=>{this.showLanguageMenu()})}showLanguageMenu(){import("./language-menu.js").then(n=>{(new n.default).show()})}}